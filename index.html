<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Dilli Wissel App</title>

<!-- PWA / iOS Standalone -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Dilli Wissel">
<meta name="theme-color" content="#F5F5F7">
<meta name="description" content="Jeugdvoetbal wisselmanager voor v.v. Dilettant">


<!-- iOS App Icon -->
<link rel="apple-touch-icon" sizes="180x180" href="data:image/png;base64,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">

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,500;0,9..40,700&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">

<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  html, body, #root { width: 100%; min-height: 100vh; margin: 0; padding: 0; background: #F5F5F7; }
  body { overflow-x: hidden; -webkit-text-size-adjust: 100%; -webkit-tap-highlight-color: transparent; color: #1A1D23; font-family: "DM Sans", sans-serif; }
  /* iOS safe areas */
  body { padding-top: env(safe-area-inset-top); padding-bottom: env(safe-area-inset-bottom); }
  input, textarea, button { -webkit-appearance: none; }
</style>

<!-- React + Tone.js from CDN -->
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
<script>
// Suppress Tone.js startup log
const _origLog = console.log;
console.log = function(...args) {
  if (args[0] && typeof args[0] === 'string' && args[0].includes('Tone.js')) return;
  _origLog.apply(console, args);
};
</script>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script>
// Suppress Babel in-browser warning
const _origWarn = console.warn;
console.warn = function(...args) {
  if (args[0] && typeof args[0] === 'string' && args[0].includes('in-browser Babel')) return;
  _origWarn.apply(console, args);
};
</script>

<!-- PWA Manifest (inline) -->
<link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiRGlsbGkgV2lzc2VsIEFwcCIsInNob3J0X25hbWUiOiJEaWxsaSBXaXNzZWwiLCJkZXNjcmlwdGlvbiI6IkpldWdkdm9ldGJhbCB3aXNzZWxtYW5hZ2VyIHZvb3Igdi52LiBEaWxldHRhbnQiLCJzdGFydF91cmwiOiIuIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiI0Y1RjVGNyIsInRoZW1lX2NvbG9yIjoiI0Y1RjVGNyJ9">

<!-- Service Worker for offline caching -->
<script>
if ('serviceWorker' in navigator) {
  const swCode = `self.addEventListener('install', e => { self.skipWaiting(); });
self.addEventListener('activate', e => { e.waitUntil(clients.claim()); });
self.addEventListener('fetch', e => { e.respondWith(fetch(e.request).catch(() => caches.match(e.request))); });`;
  const blob = new Blob([swCode], { type: 'application/javascript' });
  navigator.serviceWorker.register(URL.createObjectURL(blob)).catch(() => {});
}
</script>
</head>
<body>
<div id="root"></div>

<script type="text/babel" data-type="module">
const { useState, useEffect, useRef, useCallback } = React;



const VIEWS = { SETUP: "setup", MATCH: "match", SUMMARY: "summary" };

// ‚îÄ‚îÄ‚îÄ SVG Icons ‚îÄ‚îÄ‚îÄ
const Icons = {
  football: (size = 24, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round">
      <circle cx="12" cy="12" r="10" />
      <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20" />
      <path d="M2 12h20" />
      <path d="M12 2c2.5 3.2 4 6.5 4 10s-1.5 6.8-4 10" />
      <path d="M12 2c-2.5 3.2-4 6.5-4 10s1.5 6.8 4 10" />
    </svg>
  ),
  glove: (size = 18, color = "#D97706") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round">
      <path d="M6.5 20V15.5C6.5 14.4 5.6 13.5 4.5 13.5V9.5C4.5 8.4 5.4 7.5 6.5 7.5V4C6.5 3.2 7.2 2.5 8 2.5S9.5 3.2 9.5 4V7" />
      <path d="M9.5 7V3.5C9.5 2.7 10.2 2 11 2S12.5 2.7 12.5 3.5V7" />
      <path d="M12.5 7V3C12.5 2.2 13.2 1.5 14 1.5S15.5 2.2 15.5 3V7" />
      <path d="M15.5 7V4.5C15.5 3.7 16.2 3 17 3S18.5 3.7 18.5 4.5V13" />
      <path d="M18.5 13L19 14.5C19.3 15.5 19.5 16.5 19.5 17.5V18C19.5 20.2 17.7 22 15.5 22H11C8.8 22 6.5 20.5 6.5 18" />
    </svg>
  ),
  camera: (size = 24, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round">
      <path d="M14.5 4H9.5L7.5 6.5H4C3.2 6.5 2.5 7.2 2.5 8V18.5C2.5 19.3 3.2 20 4 20H20C20.8 20 21.5 19.3 21.5 18.5V8C21.5 7.2 20.8 6.5 20 6.5H16.5L14.5 4Z" />
      <circle cx="12" cy="13" r="3.5" />
    </svg>
  ),
  timer: (size = 20, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round">
      <circle cx="12" cy="13" r="9" />
      <path d="M12 9V13L15 15" />
      <path d="M9 1H15" />
      <path d="M12 1V4" />
    </svg>
  ),
  swap: (size = 24, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round">
      <path d="M7 4L3 8L7 12" />
      <path d="M3 8H17" />
      <path d="M17 20L21 16L17 12" />
      <path d="M21 16H7" />
    </svg>
  ),
  arrowDown: (size = 16, color = "#DC2626") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
      <path d="M12 5V19" /><path d="M5 12L12 19L19 12" />
    </svg>
  ),
  arrowUp: (size = 16, color = "#16A34A") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
      <path d="M12 19V5" /><path d="M5 12L12 5L19 12" />
    </svg>
  ),
  whistle: (size = 28, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round">
      <path d="M2 9C2 9 4 7 8 7H12L17 4" />
      <circle cx="16" cy="13" r="6" />
      <path d="M12 7V11" />
      <path d="M18 10L20 6" />
      <circle cx="16" cy="13" r="2" fill={color} opacity="0.3" />
    </svg>
  ),
  flag: (size = 32, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round">
      <path d="M4 22V2" />
      <path d="M4 2C4 2 6 1 10 1C14 1 16 3 20 3V13C16 13 14 11 10 11C6 11 4 12 4 12" />
    </svg>
  ),
  pause: (size = 14, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill={color}><rect x="5" y="3" width="5" height="18" rx="1" /><rect x="14" y="3" width="5" height="18" rx="1" /></svg>
  ),
  play: (size = 14, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill={color}><path d="M6 3L20 12L6 21V3Z" /></svg>
  ),
  check: (size = 18, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
      <path d="M5 13L9 17L19 7" />
    </svg>
  ),
  x: (size = 14, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round"><path d="M6 6L18 18M6 18L18 6" /></svg>
  ),
  chevUp: (size = 10, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="3" strokeLinecap="round"><path d="M6 16L12 10L18 16" /></svg>
  ),
  chevDown: (size = 10, color = "currentColor") => (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="3" strokeLinecap="round"><path d="M6 8L12 14L18 8" /></svg>
  ),
};

// ‚îÄ‚îÄ‚îÄ Dilettant Logo (SVG) ‚îÄ‚îÄ‚îÄ
const DilliLogo = ({ size = 72 }) => (
  <svg width={size} height={size} viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
    <circle cx="100" cy="100" r="98" fill="white" stroke="#222" strokeWidth="3"/>
    <circle cx="100" cy="100" r="82" fill="white" stroke="#222" strokeWidth="2"/>
    <clipPath id="dilli-clip"><circle cx="100" cy="100" r="60"/></clipPath>
    <g clipPath="url(#dilli-clip)">
      <rect x="40" y="40" width="120" height="120" fill="white"/>
      <rect x="52" y="40" width="14" height="120" fill="#CC0000"/>
      <rect x="78" y="40" width="14" height="120" fill="#CC0000"/>
      <rect x="104" y="40" width="14" height="120" fill="#CC0000"/>
      <rect x="130" y="40" width="14" height="120" fill="#CC0000"/>
    </g>
    <circle cx="100" cy="100" r="60" fill="none" stroke="#222" strokeWidth="2"/>
    <defs>
      <path id="dilli-top" d="M 25,100 a 75,75 0 0,1 150,0"/>
      <path id="dilli-bot" d="M 175,100 a 75,75 0 0,1 -150,0"/>
    </defs>
    <text fontSize="15" fontWeight="700" fontFamily="Arial,sans-serif" fill="#222" letterSpacing="2">
      <textPath href="#dilli-top" startOffset="50%" textAnchor="middle">v.v. DILETTANT</textPath>
    </text>
    <text fontSize="13" fontWeight="700" fontFamily="Arial,sans-serif" fill="#222" letterSpacing="1.5">
      <textPath href="#dilli-bot" startOffset="50%" textAnchor="middle">KRIMPEN A/D LEK</textPath>
    </text>
  </svg>
);

// ‚îÄ‚îÄ‚îÄ Audio: Tone.js whistle ‚îÄ‚îÄ‚îÄ
let _toneStarted = false;
const playWhistle = () => {
  try {
    if (!_toneStarted) { Tone.start(); _toneStarted = true; }
    const synth = new Tone.Synth({ oscillator: { type: "sine" }, envelope: { attack: 0.01, decay: 0.1, sustain: 0.5, release: 0.2 } }).toDestination();
    synth.triggerAttackRelease(3200, 0.5);
  } catch (e) { console.warn("Whistle:", e); }
};

const vibrate = (pattern = [200, 100, 200]) => { try { navigator.vibrate?.(pattern); } catch(e) {} };
const notifySub = () => { playWhistle(); vibrate([200, 100, 200]); };
const notifyHalf = () => { playWhistle(); vibrate([200, 100, 300, 100, 200]); };
const notifyEnd = () => { playWhistle(); vibrate([300, 150, 300, 150, 500]); };

const fireConfetti = () => {
  const canvas = document.createElement("canvas");
  canvas.style.cssText = "position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9999";
  canvas.width = window.innerWidth; canvas.height = window.innerHeight;
  document.body.appendChild(canvas);
  const ctx = canvas.getContext("2d");
  const colors = ["#16A34A","#22C55E","#FCD34D","#F97316","#EF4444","#3B82F6","#A855F7","#EC4899","#FFFFFF"];
  const pieces = Array.from({length: 120}, () => ({
    x: canvas.width * 0.5 + (Math.random() - 0.5) * 100,
    y: canvas.height * 0.5,
    vx: (Math.random() - 0.5) * 18,
    vy: -Math.random() * 22 - 5,
    r: Math.random() * 6 + 3,
    color: colors[Math.floor(Math.random() * colors.length)],
    rot: Math.random() * 360,
    rotV: (Math.random() - 0.5) * 12,
    shape: Math.random() > 0.5 ? "rect" : "circle",
    gravity: 0.35 + Math.random() * 0.15,
    opacity: 1
  }));
  let frame = 0;
  const animate = () => {
    frame++;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    let alive = false;
    pieces.forEach(p => {
      p.x += p.vx; p.y += p.vy; p.vy += p.gravity;
      p.vx *= 0.99; p.rot += p.rotV;
      if (frame > 40) p.opacity = Math.max(0, p.opacity - 0.02);
      if (p.opacity <= 0) return;
      alive = true;
      ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.rot * Math.PI / 180);
      ctx.globalAlpha = p.opacity; ctx.fillStyle = p.color;
      if (p.shape === "rect") ctx.fillRect(-p.r, -p.r/2, p.r*2, p.r);
      else { ctx.beginPath(); ctx.arc(0, 0, p.r, 0, Math.PI*2); ctx.fill(); }
      ctx.restore();
    });
    if (alive && frame < 120) requestAnimationFrame(animate);
    else { canvas.remove(); }
  };
  requestAnimationFrame(animate);
};

const fmt = (s) => `${Math.floor(s / 60)}:${(s % 60).toString().padStart(2, "0")}`;

// ‚îÄ‚îÄ‚îÄ Fonts ‚îÄ‚îÄ‚îÄ
const fontLink = document.createElement("link");
fontLink.href = "https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,500;0,9..40,700&family=JetBrains+Mono:wght@500;700&display=swap";
fontLink.rel = "stylesheet";
if (!document.querySelector('link[href*="DM+Sans"]')) document.head.appendChild(fontLink);

// ‚îÄ‚îÄ‚îÄ Theme (Light Mode) ‚îÄ‚îÄ‚îÄ
const T = {
  bg: "#F5F5F7", card: "#FFFFFF", cardBorder: "#E2E5EA",
  text: "#1A1D23", textDim: "#6B7280", textMuted: "#9CA3AF",
  accent: "#16A34A", accentDim: "#DCFCE7",
  warn: "#D97706", warnDim: "#FEF3C7",
  danger: "#DC2626", dangerDim: "#FEE2E2",
  keeper: "#D97706", keeperDim: "#FEF3C7",
  glass: "rgba(0,0,0,0.03)", glassBorder: "rgba(0,0,0,0.08)",
};
const base = { fontFamily: "'DM Sans',sans-serif", color: T.text, background: T.bg, minHeight: "100vh", width: "100%", margin: 0, padding: 0 };
const card = { background: T.card, border: `1px solid ${T.cardBorder}`, borderRadius: 16, boxShadow: "0 1px 3px rgba(0,0,0,0.06)" };
const mono = { fontFamily: "'JetBrains Mono',monospace" };
const btnP = { background: T.accent, color: "#FFFFFF", border: "none", borderRadius: 14, fontWeight: 700, cursor: "pointer", fontFamily: "'DM Sans',sans-serif", fontSize: 15, transition: "all 0.2s" };
const btnS = { background: T.glass, color: T.textDim, border: `1px solid ${T.glassBorder}`, borderRadius: 14, fontWeight: 600, cursor: "pointer", fontFamily: "'DM Sans',sans-serif", fontSize: 14, transition: "all 0.2s" };
const btnD = { ...btnS, color: T.danger, borderColor: T.dangerDim };

const Badge = ({ children, variant = "field" }) => {
  const c = { field: { bg: T.accentDim, c: T.accent }, bench: { bg: "#FEF3C7", c: T.warn }, keeper: { bg: T.keeperDim, c: T.keeper }, manual: { bg: "#DBEAFE", c: "#2563EB" } }[variant];
  return <span style={{ display: "inline-block", padding: "2px 10px", borderRadius: 20, fontSize: 11, fontWeight: 600, background: c.bg, color: c.c, letterSpacing: 0.3 }}>{children}</span>;
};

function DilliWissel() {
  const [players, setPlayers] = useState([]);
  const [keeper, setKeeper] = useState(null);
  const [newPlayer, setNewPlayer] = useState("");
  const [playersOnField, setPlayersOnField] = useState(5);
  const [halfDuration, setHalfDuration] = useState(20);
  const [halves, setHalves] = useState(2);
  const [subInterval, setSubInterval] = useState(5);
  const [view, setView] = useState(VIEWS.SETUP);
  const [onField, setOnField] = useState([]);
  const [onBench, setOnBench] = useState([]);
  const [playTime, setPlayTime] = useState({});
  const [currentHalf, setCurrentHalf] = useState(1);
  const [matchTimer, setMatchTimer] = useState(0);
  const [subTimer, setSubTimer] = useState(0);
  const [isRunning, setIsRunning] = useState(false);
  const [isPaused, setIsPaused] = useState(false);
  const [showSubAlert, setShowSubAlert] = useState(false);
  const [suggestedSubs, setSuggestedSubs] = useState({ out: [], inn: [] });
  const [subHistory, setSubHistory] = useState([]);
  const [halfBreak, setHalfBreak] = useState(false);
  const [manualSubMode, setManualSubMode] = useState(null);
  const [showPaste, setShowPaste] = useState(false);
  const [clipboardNames, setClipboardNames] = useState([]);
  const [showClipBanner, setShowClipBanner] = useState(false);
  const [clipDismissed, setClipDismissed] = useState("");
  const [pasteText, setPasteText] = useState("");
  const [pasteResult, setPasteResult] = useState(null);
  const [matchKeeper, setMatchKeeper] = useState(null);
  const [showKeeperPicker, setShowKeeperPicker] = useState(false);
  const [homeTeam, setHomeTeam] = useState("Dilettant");
  const [awayTeam, setAwayTeam] = useState("");
  const [homeScore, setHomeScore] = useState(0);
  const [awayScore, setAwayScore] = useState(0);

  const parseNames = (text) => {
    if (!text || !text.trim()) return [];
    const lines = text.split("\n").map(function(l) { return l.trim(); }).filter(Boolean);
    var names = [];
    var skip = /versterking|n\.t\.b|coach|trainer|grens|scheids|verzamel|thuis|uit|tegen|wedstrijd/i;
    for (var i = 0; i < lines.length; i++) {
      var line = lines[i];
      // Strip leading whitespace, numbers, dots, dashes, colons, bullets, common emoji
      var clean = line.replace(/^[\s\d\.\)\-:;]+/, "").replace(/^[^a-zA-Z√Ä-√ø]+/, "").trim();
      if (!clean || clean.length < 2 || clean.length > 30) continue;
      if (skip.test(clean)) continue;
      if (/^\d+$/.test(clean)) continue;
      var firstName = clean.split(/\s+/)[0];
      if (firstName && firstName.length >= 2) names.push(firstName);
    }
    return names;
  };

  const parsePastedNames = () => {
    if (!pasteText.trim()) return;
    const names = parseNames(pasteText);
    const newN = names.filter(n => !players.includes(n));
    if (newN.length > 0) {
      setPlayers(p => [...p, ...newN]);
      setPasteResult({ count: newN.length, names: newN });
    } else if (names.length > 0) {
      setPasteResult({ count: 0, names });
    } else {
      setPasteResult({ count: -1 });
    }
    setPasteText("");
    setTimeout(() => setShowPaste(false), 1500);
  };

  const tryReadClipboard = async () => {
    try {
      const text = await navigator.clipboard.readText();
      if (!text || text === clipDismissed) return;
      const found = parseNames(text);
      const newFound = found.filter(n => !players.includes(n));
      if (newFound.length >= 2) {
        setClipboardNames(newFound);
        setShowClipBanner(true);
      }
    } catch(e) {}
  };

  useEffect(() => {
    const handler = () => { if (document.visibilityState === "visible") tryReadClipboard(); };
    document.addEventListener("visibilitychange", handler);
    return () => document.removeEventListener("visibilitychange", handler);
  });

  const intervalRef = useRef(null);
  const alertShownRef = useRef(false);
  const totalMatchTime = halfDuration * halves;

  const addPlayer = () => { const n = newPlayer.trim(); if (n && !players.includes(n)) { setPlayers([...players, n]); setNewPlayer(""); } };
  const removePlayer = (name) => { setPlayers(players.filter(p => p !== name)); if (keeper === name) setKeeper(null); };
  const movePlayer = (i, d) => { const a = [...players]; const n = i + d; if (n < 0 || n >= a.length) return; [a[i], a[n]] = [a[n], a[i]]; setPlayers(a); };
  const toggleKeeper = (name) => setKeeper(keeper === name ? null : name);

  const calculateSubs = useCallback((field, bench, pt, kp) => {
    if (bench.length === 0) return { out: [], inn: [] };
    const el = field.filter(p => p !== kp);
    if (el.length === 0) return { out: [], inn: [] };
    const n = Math.min(bench.length, Math.max(1, bench.length));
    return { out: [...el].sort((a, b) => (pt[b] || 0) - (pt[a] || 0)).slice(0, n), inn: [...bench].sort((a, b) => (pt[a] || 0) - (pt[b] || 0)).slice(0, n) };
  }, []);

  const startMatch = () => {
    if (players.length <= playersOnField) return;
    playWhistle();
    const init = {}; players.forEach(p => (init[p] = 0));
    let fl, bl;
    if (keeper) { const nk = players.filter(p => p !== keeper); fl = [keeper, ...nk.slice(0, playersOnField - 1)]; bl = nk.slice(playersOnField - 1); }
    else { fl = players.slice(0, playersOnField); bl = players.slice(playersOnField); }
    setOnField(fl); setOnBench(bl); setMatchKeeper(keeper);
    setPlayTime(init); setCurrentHalf(1); setMatchTimer(0); setSubTimer(0);
    setIsRunning(true); setIsPaused(false); setShowSubAlert(false);
    setSubHistory([]); setHalfBreak(false); alertShownRef.current = false;
    setHomeScore(0); setAwayScore(0);
    setView(VIEWS.MATCH);
  };

  useEffect(() => {
    if (isRunning && !isPaused && !halfBreak) {
      intervalRef.current = setInterval(() => {
        setMatchTimer(p => p + 1);
        setSubTimer(p => p + 1);
        setOnField(cf => { setPlayTime(prev => { const n = { ...prev }; cf.forEach(p => (n[p] = (n[p] || 0) + 1)); return n; }); return cf; });
      }, 1000);
    }
    return () => clearInterval(intervalRef.current);
  }, [isRunning, isPaused, halfBreak]);

  useEffect(() => {
    if (!isRunning || isPaused || halfBreak) return;
    const hs = halfDuration * 60;
    const he = matchTimer - (currentHalf - 1) * hs;
    if (he >= hs) {
      clearInterval(intervalRef.current);
      if (currentHalf < halves) { setHalfBreak(true); setShowSubAlert(false); notifyHalf(); }
      else { setIsRunning(false); notifyEnd(); setView(VIEWS.SUMMARY); }
      return;
    }
    if (subTimer >= subInterval * 60 && !alertShownRef.current && onBench.length > 0) {
      alertShownRef.current = true;
      setSuggestedSubs(calculateSubs(onField, onBench, playTime, matchKeeper));
      setShowSubAlert(true);
      notifySub();
    }
  }, [matchTimer, subTimer, isRunning, isPaused, halfBreak, currentHalf, halves, halfDuration, subInterval, onField, onBench, playTime, calculateSubs, matchKeeper]);

  const executeSubs = () => {
    const { out, inn } = suggestedSubs;
    setOnField(onField.filter(p => !out.includes(p)).concat(inn));
    setOnBench(onBench.filter(p => !inn.includes(p)).concat(out));
    setSubHistory(h => [...h, { time: fmt(matchTimer), half: currentHalf, out: [...out], inn: [...inn] }]);
    setShowSubAlert(false); setSubTimer(0); alertShownRef.current = false;
  };
  const skipSubs = () => { setShowSubAlert(false); setSubTimer(0); alertShownRef.current = false; };
  const startNextHalf = () => {
    setCurrentHalf(p => p + 1); setHalfBreak(false); setSubTimer(0); alertShownRef.current = false;
    if (onBench.length > 0) { setSuggestedSubs(calculateSubs(onField, onBench, playTime, matchKeeper)); setShowSubAlert(true); notifySub(); }
  };

  const manualSub = (fp, bp) => {
    const wasKeeper = fp === matchKeeper;
    setOnField(onField.map(p => (p === fp ? bp : p)));
    setOnBench(onBench.map(p => (p === bp ? fp : p)));
    if (wasKeeper) setMatchKeeper(bp);
    setSubHistory(h => [...h, { time: fmt(matchTimer), half: currentHalf, out: [fp], inn: [bp], manual: true, keeperSwap: wasKeeper }]);
  };

  const swapKeeper = (newKeeper) => {
    setMatchKeeper(newKeeper);
    setSubHistory(h => [...h, { time: fmt(matchTimer), half: currentHalf, out: [], inn: [], keeperChange: true, newKeeper }]);
    setShowKeeperPicker(false);
  };

  const Stepper = ({ label, value, set, min, step }) => (
    <div>
      <div style={{ fontSize: 11, color: T.textDim, marginBottom: 6, textTransform: "uppercase", letterSpacing: 1, fontWeight: 500 }}>{label}</div>
      <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
        <button onClick={() => set(Math.max(min, value - step))} style={{ ...btnS, width: 36, height: 36, padding: 0, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 18, borderRadius: 10 }}>‚àí</button>
        <span style={{ ...mono, fontSize: 24, fontWeight: 700, width: 36, textAlign: "center" }}>{value}</span>
        <button onClick={() => set(value + step)} style={{ ...btnS, width: 36, height: 36, padding: 0, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 18, borderRadius: 10 }}>+</button>
      </div>
    </div>
  );

  const styles = `*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}html,body,#root{width:100%;min-height:100vh;margin:0;padding:0;background:#F5F5F7}body{overflow-x:hidden}@keyframes spin{to{transform:rotate(360deg)}}@keyframes pulse{0%,100%{opacity:.4}50%{opacity:1}}@keyframes slideIn{from{transform:translateY(-10px);opacity:0}to{transform:translateY(0);opacity:1}}`;

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SETUP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  if (view === VIEWS.SETUP) {
    const canStart = players.length > playersOnField;
    return (
      <div style={base}><style>{styles}</style>
        <div style={{ maxWidth: 480, margin: "0 auto", padding: "16px 16px 32px" }}>
          <div style={{ textAlign: "center", padding: "24px 0 20px" }}>
            <DilliLogo size={72} />
            <div style={{ fontSize: 13, fontWeight: 600, color: T.accent, letterSpacing: 3, textTransform: "uppercase", marginTop: 8, marginBottom: 4 }}>Dilli Wissel App</div>
            <p style={{ color: T.textDim, fontSize: 14, marginTop: 6 }}>Jeugdvoetbal wisselmanager</p>
          </div>

          {/* Clipboard auto-detect banner removed ‚Äî pure file sharing mode */}

          <div style={{ ...card, padding: 20, marginBottom: 12 }}>
            <div style={{ fontSize: 13, fontWeight: 600, color: T.textDim, marginBottom: 16, textTransform: "uppercase", letterSpacing: 1 }}>Wedstrijd</div>
            <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 20 }}>
              <Stepper label="In veld" value={playersOnField} set={setPlayersOnField} min={3} step={1} />
              <Stepper label="Helften" value={halves} set={setHalves} min={1} step={1} />
              <Stepper label="Min / helft" value={halfDuration} set={setHalfDuration} min={5} step={5} />
              <Stepper label="Wissel elke" value={subInterval} set={setSubInterval} min={2} step={1} />
            </div>
            <div style={{ marginTop: 16, display: "flex", gap: 8 }}>
              <div style={{ flex: 1 }}>
                <div style={{ fontSize: 11, color: T.textDim, marginBottom: 4, textTransform: "uppercase", letterSpacing: 1, fontWeight: 500 }}>Thuis</div>
                <input type="text" value={homeTeam} onChange={e => setHomeTeam(e.target.value)} placeholder="Thuisploeg" style={{ width: "100%", padding: "9px 12px", background: T.glass, border: `1px solid ${T.glassBorder}`, borderRadius: 10, color: T.text, fontSize: 14, fontFamily: "'DM Sans',sans-serif", outline: "none", boxSizing: "border-box" }} />
              </div>
              <div style={{ flex: 1 }}>
                <div style={{ fontSize: 11, color: T.textDim, marginBottom: 4, textTransform: "uppercase", letterSpacing: 1, fontWeight: 500 }}>Uit</div>
                <input type="text" value={awayTeam} onChange={e => setAwayTeam(e.target.value)} placeholder="Tegenstander" style={{ width: "100%", padding: "9px 12px", background: T.glass, border: `1px solid ${T.glassBorder}`, borderRadius: 10, color: T.text, fontSize: 14, fontFamily: "'DM Sans',sans-serif", outline: "none", boxSizing: "border-box" }} />
              </div>
            </div>
            <div style={{ marginTop: 12, padding: "10px 14px", borderRadius: 10, background: T.glass, border: `1px solid ${T.glassBorder}`, fontSize: 13, color: T.textDim }}>
              {halves}√ó{halfDuration}min = {totalMatchTime}min
              {keeper && <span style={{ color: T.keeper }}> ¬∑ {Icons.glove(12, T.keeper)} {keeper}</span>}
            </div>
          </div>

          <div style={{ ...card, padding: 20, marginBottom: 12 }}>
            <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 16 }}>
              <div style={{ fontSize: 13, fontWeight: 600, color: T.textDim, textTransform: "uppercase", letterSpacing: 1 }}>Selectie <span style={{ color: T.text }}>{players.length}</span></div>
              {players.length > 0 && <div style={{ fontSize: 12, color: T.textMuted }}>{Math.min(playersOnField, players.length)} veld ¬∑ {Math.max(0, players.length - playersOnField)} bank</div>}
            </div>

            {showClipBanner && clipboardNames.length > 0 && (
              <div style={{ marginBottom: 12, padding: 14, borderRadius: 12, background: "rgba(22,163,74,0.08)", border: "1px solid rgba(22,163,74,0.25)", display: "flex", flexDirection: "column", gap: 8 }}>
                <div style={{ fontSize: 14, fontWeight: 600, color: T.accent }}>{clipboardNames.length} spelers op klembord gevonden</div>
                <div style={{ fontSize: 12, color: T.textDim }}>{clipboardNames.join(", ")}</div>
                <div style={{ display: "flex", gap: 8 }}>
                  <button onClick={() => { setPlayers(p => [...p, ...clipboardNames]); setShowClipBanner(false); vibrate([100]); }} style={{ ...btnP, flex: 1, padding: "8px 0", fontSize: 13 }}>Toevoegen</button>
                  <button onClick={() => { setClipDismissed(clipboardNames.join(",")); setShowClipBanner(false); setClipboardNames([]); }} style={{ ...btnS, flex: 1, padding: "8px 0", fontSize: 13 }}>Nee, bedankt</button>
                </div>
              </div>
            )}

            <div onClick={() => { setShowPaste(true); setPasteResult(null); }} style={{ marginBottom: 12, padding: 16, borderRadius: 12, border: `2px dashed ${T.cardBorder}`, textAlign: "center", cursor: "pointer", transition: "all 0.2s", background: T.glass }}
              onMouseEnter={e => { e.currentTarget.style.borderColor = T.accent; }} onMouseLeave={e => { e.currentTarget.style.borderColor = T.cardBorder; }}>
              <div style={{ marginBottom: 4, opacity: 0.6 }}><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke={T.textDim} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></div>
              <p style={{ fontSize: 14, color: T.text, fontWeight: 600 }}>Spelers plakken</p>
              <p style={{ fontSize: 12, color: T.textMuted, marginTop: 2 }}>Kopieer de lijst uit WhatsApp</p>
            </div>

            {showPaste && (
              <div style={{ position: "fixed", inset: 0, background: "rgba(0,0,0,0.3)", backdropFilter: "blur(8px)", display: "flex", alignItems: "center", justifyContent: "center", zIndex: 1000, padding: 20 }}>
                <div style={{ background: T.card, border: `1px solid ${T.cardBorder}`, borderRadius: 20, padding: 24, width: "100%", maxWidth: 380, animation: "slideIn .25s", boxShadow: "0 20px 60px rgba(0,0,0,0.15)" }}>
                  <h3 style={{ color: T.text, fontSize: 16, fontWeight: 700, marginBottom: 4 }}>Spelers plakken</h3>
                  <p style={{ color: T.textMuted, fontSize: 12, marginBottom: 12 }}>Plak een genummerde lijst, bv. uit WhatsApp:</p>
                  <textarea value={pasteText} onChange={e => setPasteText(e.target.value)} placeholder={"1. Luuk\n2. Daan\n3. Morris\n4. Nolan\n..."} rows={7} style={{ width: "100%", padding: 12, background: T.glass, border: `1px solid ${T.glassBorder}`, borderRadius: 12, color: T.text, fontSize: 14, fontFamily: "'DM Sans',sans-serif", outline: "none", resize: "vertical", boxSizing: "border-box" }} autoFocus />
                  {pasteResult && (
                    <p style={{ fontSize: 13, marginTop: 8, fontWeight: 500, color: pasteResult.count > 0 ? T.accent : pasteResult.count === 0 ? T.textDim : T.warn }}>
                      {pasteResult.count > 0 ? `‚úì ${pasteResult.count} speler${pasteResult.count !== 1 ? "s" : ""} toegevoegd: ${pasteResult.names.join(", ")}` : pasteResult.count === 0 ? "Alle namen stonden er al in" : "Geen namen herkend ‚Äî probeer een genummerde lijst"}
                    </p>
                  )}
                  <div style={{ display: "flex", gap: 10, marginTop: 14 }}>
                    <button onClick={() => { setShowPaste(false); setPasteText(""); setPasteResult(null); }} style={{ ...btnS, flex: 1, padding: "10px 0" }}>Annuleer</button>
                    <button onClick={async () => { try { const t = await navigator.clipboard.readText(); if (t) setPasteText(t); } catch(e) {} }} style={{ ...btnS, padding: "10px 12px" }}>üìã</button>
                    <button onClick={parsePastedNames} disabled={!pasteText.trim()} style={{ ...btnP, flex: 1, padding: "10px 0", opacity: pasteText.trim() ? 1 : 0.4 }}>Herken namen</button>
                  </div>
                </div>
              </div>
            )}

            <div style={{ display: "flex", gap: 8, marginBottom: 16 }}>
              <input type="text" value={newPlayer} onChange={e => setNewPlayer(e.target.value)} onKeyDown={e => e.key === "Enter" && addPlayer()} placeholder="Naam toevoegen..." style={{ flex: 1, padding: "10px 14px", background: T.glass, border: `1px solid ${T.glassBorder}`, borderRadius: 12, color: T.text, fontSize: 14, fontFamily: "'DM Sans',sans-serif", outline: "none" }} />
              <button onClick={addPlayer} style={{ ...btnP, padding: "10px 18px" }}>+</button>
            </div>

            {players.length > 0 && <p style={{ fontSize: 11, color: T.textMuted, marginBottom: 10, textAlign: "center" }}>Tik {Icons.glove(11, T.textMuted)} voor keeper</p>}

            <div style={{ display: "flex", flexDirection: "column", gap: 4 }}>
              {players.map((p, i) => {
                const isK = keeper === p;
                const isField = isK || (keeper ? players.filter((pl, idx) => idx < i && pl !== keeper).length + 1 < playersOnField : i < playersOnField);
                return (
                  <div key={p} style={{ display: "flex", alignItems: "center", justifyContent: "space-between", padding: "8px 12px", borderRadius: 10, background: isK ? "rgba(217,119,6,0.06)" : isField ? "rgba(22,163,74,0.04)" : "rgba(217,119,6,0.04)", border: isK ? `1px solid ${T.keeperDim}` : `1px solid ${T.glassBorder}` }}>
                    <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
                      <div style={{ display: "flex", flexDirection: "column" }}>
                        <button onClick={() => movePlayer(i, -1)} style={{ background: "none", border: "none", cursor: "pointer", padding: 0, lineHeight: 1, display: "flex" }}>{Icons.chevUp(10, T.textMuted)}</button>
                        <button onClick={() => movePlayer(i, 1)} style={{ background: "none", border: "none", cursor: "pointer", padding: 0, lineHeight: 1, display: "flex" }}>{Icons.chevDown(10, T.textMuted)}</button>
                      </div>
                      <button onClick={() => toggleKeeper(p)} style={{ background: "none", border: "none", cursor: "pointer", padding: 0, opacity: isK ? 1 : 0.3, transition: "opacity 0.2s", display: "flex" }}>{Icons.glove(16, isK ? T.keeper : T.textMuted)}</button>
                      <span style={{ fontWeight: 600, fontSize: 14, color: T.text }}>{p}</span>
                      {isK ? <Badge variant="keeper">Keeper</Badge> : isField ? <Badge variant="field">Veld</Badge> : <Badge variant="bench">Bank</Badge>}
                    </div>
                    <button onClick={() => removePlayer(p)} style={{ background: "none", border: "none", cursor: "pointer", padding: 4, display: "flex", opacity: 0.4, transition: "opacity 0.2s" }} onMouseEnter={e => e.currentTarget.style.opacity = 1} onMouseLeave={e => e.currentTarget.style.opacity = 0.4}>{Icons.x(14, T.danger)}</button>
                  </div>
                );
              })}
            </div>
            {players.length > 0 && <button onClick={() => { setPlayers([]); setKeeper(null); }} style={{ background: "none", border: "none", color: T.textMuted, fontSize: 12, cursor: "pointer", marginTop: 12, fontFamily: "'DM Sans',sans-serif" }}>Alles wissen</button>}
          </div>

          <button onClick={startMatch} disabled={!canStart} style={{ ...btnP, width: "100%", padding: "16px 0", fontSize: 16, opacity: canStart ? 1 : 0.3, cursor: canStart ? "pointer" : "not-allowed", boxShadow: canStart ? "0 4px 16px rgba(22,163,74,0.25)" : "none" }}>
            {!canStart ? `Nog ${Math.max(1, playersOnField - players.length + 1)} speler${playersOnField - players.length + 1 !== 1 ? "s" : ""} nodig` : "Start wedstrijd ‚Üí"}
          </button>
        </div>
      </div>
    );
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SUMMARY ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  if (view === VIEWS.SUMMARY) {
    const sorted = [...players].sort((a, b) => (playTime[b] || 0) - (playTime[a] || 0));
    const max = Math.max(...Object.values(playTime), 1);
    return (
      <div style={base}><style>{styles}</style>
        <div style={{ maxWidth: 480, margin: "0 auto", padding: "16px 16px 32px" }}>
          <div style={{ textAlign: "center", padding: "24px 0 20px" }}>
            <DilliLogo size={56} />
            <div style={{ marginBottom: 8, marginTop: 8 }}>{Icons.flag(28, T.accent)}</div>
            <h1 style={{ fontSize: 24, fontWeight: 700, margin: 0 }}>Afgelopen!</h1>
            <div style={{ marginTop: 12, display: "flex", alignItems: "center", justifyContent: "center", gap: 16 }}>
              <div style={{ textAlign: "center" }}>
                <div style={{ fontSize: 11, color: T.textMuted, textTransform: "uppercase", letterSpacing: 1, marginBottom: 2 }}>{homeTeam || "Thuis"}</div>
                <div style={{ ...mono, fontSize: 36, fontWeight: 700 }}>{homeScore}</div>
              </div>
              <span style={{ fontSize: 20, color: T.textMuted, fontWeight: 300 }}>‚Äì</span>
              <div style={{ textAlign: "center" }}>
                <div style={{ fontSize: 11, color: T.textMuted, textTransform: "uppercase", letterSpacing: 1, marginBottom: 2 }}>{awayTeam || "Uit"}</div>
                <div style={{ ...mono, fontSize: 36, fontWeight: 700 }}>{awayScore}</div>
              </div>
            </div>
          </div>
          <div style={{ ...card, padding: 20, marginBottom: 12 }}>
            <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 16 }}>{Icons.timer(18, T.textDim)}<span style={{ fontSize: 13, fontWeight: 600, color: T.textDim, textTransform: "uppercase", letterSpacing: 1 }}>Speeltijd</span></div>
            <div style={{ display: "flex", flexDirection: "column", gap: 12 }}>
              {sorted.map(p => { const t = playTime[p] || 0; const isK = p === matchKeeper; return (
                <div key={p}>
                  <div style={{ display: "flex", justifyContent: "space-between", marginBottom: 4 }}>
                    <span style={{ fontSize: 14, fontWeight: 600, display: "flex", alignItems: "center", gap: 6 }}>{isK && Icons.glove(14, T.keeper)}{p}</span>
                    <span style={{ ...mono, fontSize: 13, color: T.textDim }}>{fmt(t)}</span>
                  </div>
                  <div style={{ height: 6, background: T.glass, borderRadius: 3, overflow: "hidden" }}>
                    <div style={{ height: "100%", width: `${(t / max) * 100}%`, background: isK ? T.keeper : T.accent, borderRadius: 3, transition: "width 0.5s" }} />
                  </div>
                </div>
              ); })}
            </div>
          </div>
          {subHistory.length > 0 && (
            <div style={{ ...card, padding: 20, marginBottom: 12 }}>
              <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 12 }}>{Icons.swap(16, T.textDim)}<span style={{ fontSize: 13, fontWeight: 600, color: T.textDim, textTransform: "uppercase", letterSpacing: 1 }}>Wissels ({subHistory.length})</span></div>
              <div style={{ display: "flex", flexDirection: "column", gap: 6 }}>
                {subHistory.map((s, i) => (
                  <div key={i} style={{ padding: "10px 12px", borderRadius: 10, background: T.glass, border: `1px solid ${T.glassBorder}`, fontSize: 13 }}>
                    <div style={{ display: "flex", gap: 8, alignItems: "center", marginBottom: 4 }}>
                      <span style={{ ...mono, fontSize: 12, color: T.textMuted }}>{s.time}</span>
                      <span style={{ fontSize: 11, color: T.textMuted }}>H{s.half}</span>
                      {s.manual && <Badge variant="manual">handmatig</Badge>}
                      {s.keeperSwap && <Badge variant="keeper">keeper gewisseld</Badge>}
                      {s.keeperChange && <Badge variant="keeper">nieuwe keeper</Badge>}
                    </div>
                    {s.keeperChange ? (
                      <span style={{ color: T.keeper }}>{Icons.glove(12, T.keeper)} {s.newKeeper} is nu keeper</span>
                    ) : (
                      <span><span style={{ color: T.danger }}>‚¨á {s.out.join(", ")}</span><span style={{ color: T.textMuted }}> ‚Üí </span><span style={{ color: T.accent }}>‚¨Ü {s.inn.join(", ")}</span></span>
                    )}
                  </div>
                ))}
              </div>
            </div>
          )}
          <button onClick={() => setView(VIEWS.SETUP)} style={{ ...btnP, width: "100%", padding: "16px 0", fontSize: 16, boxShadow: "0 4px 16px rgba(22,163,74,0.25)" }}>Nieuwe wedstrijd</button>
        </div>
      </div>
    );
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MATCH ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  const hs = halfDuration * 60;
  const he = matchTimer - (currentHalf - 1) * hs;
  const hr = hs - he;
  const sr = subInterval * 60 - subTimer;
  const hp = (he / hs) * 100;
  const urgent = sr <= 30 && onBench.length > 0 && !showSubAlert;

  return (
    <div style={base}><style>{styles}</style>
      <div style={{ maxWidth: 480, margin: "0 auto", padding: 16 }}>
        {/* Timer */}
        <div style={{ ...card, padding: 20, marginBottom: 10, position: "relative", overflow: "hidden" }}>
          {urgent && <div style={{ position: "absolute", top: 0, left: 0, right: 0, height: 2, background: `linear-gradient(90deg,transparent,${T.warn},transparent)`, animation: "pulse 1.5s ease infinite" }} />}
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", marginBottom: 16 }}>
            <div>
              <div style={{ fontSize: 11, color: T.textMuted, textTransform: "uppercase", letterSpacing: 1 }}>Helft</div>
              <div style={{ fontSize: 32, fontWeight: 700, lineHeight: 1 }}>{currentHalf}<span style={{ color: T.textMuted, fontSize: 20 }}>/{halves}</span></div>
            </div>
            <div style={{ textAlign: "right" }}>
              <div style={{ fontSize: 11, color: T.textMuted, textTransform: "uppercase", letterSpacing: 1 }}>Tijd</div>
              <div style={{ ...mono, fontSize: 32, fontWeight: 700, lineHeight: 1 }}>{fmt(matchTimer)}</div>
            </div>
          </div>
          <div style={{ height: 4, background: T.glass, borderRadius: 2, marginBottom: 12, overflow: "hidden" }}>
            <div style={{ height: "100%", width: `${Math.min(hp, 100)}%`, background: T.accent, borderRadius: 2, transition: "width 1s linear" }} />
          </div>
          <div style={{ display: "flex", justifyContent: "space-between", fontSize: 12 }}>
            <span style={{ color: T.textMuted }}>Rest: {fmt(Math.max(0, hr))}</span>
            {onBench.length > 0 && <span style={{ ...mono, color: urgent ? T.warn : T.textMuted, fontWeight: urgent ? 700 : 500 }}>Wissel: {fmt(Math.max(0, sr))}</span>}
          </div>
          <div style={{ display: "flex", gap: 8, marginTop: 14 }}>
            <button onClick={() => setIsPaused(!isPaused)} style={{ ...(isPaused ? btnP : btnS), flex: 1, padding: "10px 0", display: "flex", alignItems: "center", justifyContent: "center", gap: 6 }}>
              {isPaused ? Icons.play(12, "#FFFFFF") : Icons.pause(12, T.textDim)} {isPaused ? "Hervat" : "Pauze"}
            </button>
            <button onClick={() => setShowKeeperPicker(!showKeeperPicker)} style={{ ...btnS, padding: "10px 14px", display: "flex", alignItems: "center", gap: 6, borderColor: showKeeperPicker ? T.keeperDim : T.glassBorder }}>
              {Icons.glove(14, T.keeper)}
            </button>
            <button onClick={() => { setIsRunning(false); setView(VIEWS.SUMMARY); }} style={{ ...btnD, padding: "10px 16px" }}>Stop</button>
          </div>
        </div>

        {/* Scoreboard */}
        <div style={{ ...card, padding: "12px 16px", marginBottom: 10, display: "flex", alignItems: "center", justifyContent: "space-between" }}>
          <div style={{ flex: 1, textAlign: "center" }}>
            <div style={{ fontSize: 11, color: T.textMuted, textTransform: "uppercase", letterSpacing: 1, marginBottom: 4, overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }}>{homeTeam || "Thuis"}</div>
            <div style={{ display: "flex", alignItems: "center", justifyContent: "center", gap: 12 }}>
              <button onClick={() => setHomeScore(Math.max(0, homeScore - 1))} style={{ background: T.glass, border: `1px solid ${T.glassBorder}`, borderRadius: 8, width: 32, height: 32, cursor: "pointer", color: T.textDim, fontSize: 18, fontWeight: 700, display: "flex", alignItems: "center", justifyContent: "center", fontFamily: "'DM Sans',sans-serif" }}>‚àí</button>
              <span style={{ ...mono, fontSize: 36, fontWeight: 700, color: T.text, minWidth: 36, textAlign: "center" }}>{homeScore}</span>
              <button onClick={() => { setHomeScore(homeScore + 1); fireConfetti(); vibrate([100, 50, 200]); }} style={{ background: T.accentDim, border: `1px solid ${T.accent}33`, borderRadius: 8, width: 32, height: 32, cursor: "pointer", color: T.accent, fontSize: 18, fontWeight: 700, display: "flex", alignItems: "center", justifyContent: "center", fontFamily: "'DM Sans',sans-serif" }}>+</button>
            </div>
          </div>
          <div style={{ fontSize: 20, color: T.textMuted, fontWeight: 300, padding: "0 4px" }}>‚Äì</div>
          <div style={{ flex: 1, textAlign: "center" }}>
            <div style={{ fontSize: 11, color: T.textMuted, textTransform: "uppercase", letterSpacing: 1, marginBottom: 4, overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }}>{awayTeam || "Uit"}</div>
            <div style={{ display: "flex", alignItems: "center", justifyContent: "center", gap: 12 }}>
              <button onClick={() => setAwayScore(Math.max(0, awayScore - 1))} style={{ background: T.glass, border: `1px solid ${T.glassBorder}`, borderRadius: 8, width: 32, height: 32, cursor: "pointer", color: T.textDim, fontSize: 18, fontWeight: 700, display: "flex", alignItems: "center", justifyContent: "center", fontFamily: "'DM Sans',sans-serif" }}>‚àí</button>
              <span style={{ ...mono, fontSize: 36, fontWeight: 700, color: T.text, minWidth: 36, textAlign: "center" }}>{awayScore}</span>
              <button onClick={() => setAwayScore(awayScore + 1)} style={{ background: T.accentDim, border: `1px solid ${T.accent}33`, borderRadius: 8, width: 32, height: 32, cursor: "pointer", color: T.accent, fontSize: 18, fontWeight: 700, display: "flex", alignItems: "center", justifyContent: "center", fontFamily: "'DM Sans',sans-serif" }}>+</button>
            </div>
          </div>
        </div>

        {/* Keeper picker */}
        {showKeeperPicker && (
          <div style={{ ...card, padding: 16, marginBottom: 10, borderColor: T.keeperDim, background: "rgba(217,119,6,0.04)", animation: "slideIn 0.2s ease" }}>
            <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 12 }}>
              {Icons.glove(18, T.keeper)}
              <span style={{ fontSize: 14, fontWeight: 700, color: T.keeper }}>Keeper wisselen</span>
              <button onClick={() => setShowKeeperPicker(false)} style={{ marginLeft: "auto", background: "none", border: "none", cursor: "pointer", display: "flex", padding: 4 }}>{Icons.x(14, T.textMuted)}</button>
            </div>
            <p style={{ fontSize: 12, color: T.textDim, marginBottom: 10 }}>Kies de nieuwe keeper (blijft in het veld)</p>
            <div style={{ display: "flex", flexDirection: "column", gap: 3 }}>
              {onField.map(p => {
                const isK = p === matchKeeper;
                return (
                  <button key={p} onClick={() => !isK && swapKeeper(p)} style={{ display: "flex", alignItems: "center", justifyContent: "space-between", padding: "10px 12px", borderRadius: 10, background: isK ? "rgba(217,119,6,0.08)" : T.glass, border: `1px solid ${isK ? T.keeperDim : T.glassBorder}`, cursor: isK ? "default" : "pointer", textAlign: "left", fontFamily: "'DM Sans',sans-serif", color: T.text, width: "100%", transition: "all 0.15s" }}>
                    <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
                      {isK && Icons.glove(14, T.keeper)}
                      <span style={{ fontWeight: 600, fontSize: 14, color: T.text }}>{p}</span>
                      {isK && <Badge variant="keeper">Nu keeper</Badge>}
                    </div>
                    {!isK && <span style={{ fontSize: 12, color: T.keeper, fontWeight: 600 }}>Maak keeper ‚Üí</span>}
                  </button>
                );
              })}
            </div>
          </div>
        )}

        {/* Half break */}
        {halfBreak && (
          <div style={{ ...card, padding: 24, marginBottom: 10, textAlign: "center", borderColor: T.warnDim, background: "rgba(217,119,6,0.04)", animation: "slideIn 0.2s ease" }}>
            <div style={{ marginBottom: 8 }}>{Icons.whistle(32, T.warn)}</div>
            <h2 style={{ fontSize: 20, fontWeight: 700, color: T.warn, margin: "0 0 8px" }}>Rust!</h2>
            <p style={{ color: T.textDim, fontSize: 14, marginBottom: 16 }}>Klaar voor helft {currentHalf + 1}?</p>
            <button onClick={startNextHalf} style={{ ...btnP, width: "100%", padding: "14px 0", display: "flex", alignItems: "center", justifyContent: "center", gap: 8 }}>{Icons.play(14, "#FFFFFF")} Start helft {currentHalf + 1}</button>
          </div>
        )}

        {/* Sub alert */}
        {showSubAlert && !halfBreak && (
          <div style={{ ...card, padding: 20, marginBottom: 10, borderColor: T.warnDim, background: "rgba(217,119,6,0.04)", animation: "slideIn 0.2s ease" }}>
            <div style={{ textAlign: "center", marginBottom: 16 }}>
              <div style={{ marginBottom: 4 }}>{Icons.whistle(30, T.warn)}</div>
              <h2 style={{ fontSize: 17, fontWeight: 700, color: T.warn, margin: 0 }}>Tijd om te wisselen!</h2>
              <p style={{ fontSize: 12, color: T.textMuted, marginTop: 4 }}>Klok loopt door ‚Äî neem de tijd</p>
            </div>
            <div style={{ display: "flex", flexDirection: "column", gap: 6, marginBottom: 16 }}>
              {suggestedSubs.out.map((p, i) => (
                <div key={i} style={{ display: "flex", alignItems: "center", justifyContent: "space-between", padding: "10px 12px", borderRadius: 10, background: T.glass, border: `1px solid ${T.glassBorder}` }}>
                  <div style={{ display: "flex", alignItems: "center", gap: 6 }}>
                    {Icons.arrowDown(14)} <span style={{ fontWeight: 600, fontSize: 14, color: T.text }}>{p}</span> <span style={{ ...mono, fontSize: 11, color: T.textMuted }}>{fmt(playTime[p] || 0)}</span>
                  </div>
                  <span style={{ color: T.textMuted }}>‚Üí</span>
                  <div style={{ display: "flex", alignItems: "center", gap: 6 }}>
                    <span style={{ fontWeight: 600, fontSize: 14 }}>{suggestedSubs.inn[i]}</span> <span style={{ ...mono, fontSize: 11, color: T.textMuted }}>{fmt(playTime[suggestedSubs.inn[i]] || 0)}</span> {Icons.arrowUp(14)}
                  </div>
                </div>
              ))}
            </div>
            <div style={{ display: "flex", gap: 8 }}>
              <button onClick={executeSubs} style={{ ...btnP, flex: 1, padding: "12px 0", display: "flex", alignItems: "center", justifyContent: "center", gap: 6 }}>{Icons.check(16, "#FFFFFF")} Wissel!</button>
              <button onClick={skipSubs} style={{ ...btnS, padding: "12px 16px" }}>Sla over</button>
            </div>
          </div>
        )}

        {/* Field */}
        <div style={{ ...card, padding: 16, marginBottom: 10 }}>
          <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 12 }}>
            <div style={{ width: 8, height: 8, borderRadius: 4, background: T.accent }} />
            <span style={{ fontSize: 13, fontWeight: 600, color: T.textDim, textTransform: "uppercase", letterSpacing: 1 }}>In het veld ({onField.length})</span>
          </div>
          <div style={{ display: "flex", flexDirection: "column", gap: 3 }}>
            {[...onField.filter(p => p === matchKeeper), ...[...onField.filter(p => p !== matchKeeper)].sort((a, b) => (playTime[b] || 0) - (playTime[a] || 0))].map(p => {
              const isK = p === matchKeeper; const isSel = manualSubMode === p;
              return (
                <div key={p} onClick={() => { if (onBench.length > 0 && !showSubAlert && !halfBreak) setManualSubMode(manualSubMode === p ? null : p); }}
                  style={{ display: "flex", alignItems: "center", justifyContent: "space-between", padding: "9px 12px", borderRadius: 10, cursor: "pointer", transition: "all 0.15s",
                    background: isSel ? "rgba(220,38,38,0.06)" : isK ? "rgba(217,119,6,0.04)" : "rgba(22,163,74,0.03)",
                    border: isSel ? `1px solid ${T.dangerDim}` : `1px solid ${T.glassBorder}` }}>
                  <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
                    {isK && Icons.glove(14, T.keeper)}
                    <span style={{ fontWeight: 600, fontSize: 14, color: T.text }}>{p}</span>
                    {isK && <Badge variant="keeper">Keeper</Badge>}
                  </div>
                  <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
                    <span style={{ ...mono, fontSize: 12, color: T.textMuted }}>{fmt(playTime[p] || 0)}</span>
                    {isSel && <span style={{ fontSize: 11, color: T.danger, fontWeight: 600, display: "flex", alignItems: "center", gap: 4 }}>{Icons.arrowDown(12)} kies vervanger</span>}
                  </div>
                </div>
              );
            })}
          </div>
        </div>

        {/* Bench */}
        {onBench.length > 0 && (
          <div style={{ ...card, padding: 16, marginBottom: 10 }}>
            <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 12 }}>
              <div style={{ width: 8, height: 8, borderRadius: 4, background: T.warn }} />
              <span style={{ fontSize: 13, fontWeight: 600, color: T.textDim, textTransform: "uppercase", letterSpacing: 1 }}>Bank ({onBench.length})</span>
            </div>
            <div style={{ display: "flex", flexDirection: "column", gap: 3 }}>
              {[...onBench].sort((a, b) => (playTime[a] || 0) - (playTime[b] || 0)).map(p => (
                <div key={p} onClick={() => { if (manualSubMode) { manualSub(manualSubMode, p); setManualSubMode(null); } }}
                  style={{ display: "flex", alignItems: "center", justifyContent: "space-between", padding: "9px 12px", borderRadius: 10, transition: "all 0.15s",
                    background: manualSubMode ? "rgba(22,163,74,0.04)" : "rgba(217,119,6,0.03)",
                    border: manualSubMode ? `1px solid ${T.accentDim}` : `1px solid ${T.glassBorder}`,
                    cursor: manualSubMode ? "pointer" : "default" }}>
                  <span style={{ fontWeight: 600, fontSize: 14, color: T.text }}>{p}</span>
                  <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
                    <span style={{ ...mono, fontSize: 12, color: T.textMuted }}>{fmt(playTime[p] || 0)}</span>
                    {manualSubMode && <span style={{ fontSize: 11, color: T.accent, fontWeight: 600, display: "flex", alignItems: "center", gap: 4 }}>{Icons.arrowUp(12)} tap</span>}
                  </div>
                </div>
              ))}
            </div>
            {!manualSubMode && !showSubAlert && !halfBreak && <p style={{ fontSize: 11, color: T.textMuted, textAlign: "center", marginTop: 10, marginBottom: 0 }}>Tik op veldspeler voor handmatige wissel</p>}
          </div>
        )}
      </div>
    </div>
  );
}


ReactDOM.createRoot(document.getElementById("root")).render(<DilliWissel />);
</script>


</body>
</html>